import { MapExploiter } from "./MapExploiter.js";
import { Tile } from "./Tile.js";
import { TileGenerator } from "./TileGenerator.js";

export class TileExploiter extends Tile {
  /** @type {Number} */
  #populations = 0;

  /** @type {Biome} */
  #biome;
  /** @type {Resource} */
  #resource;
  /** @type {Building} */
  #building = null;
  /** @type {Territory} */
  #territory;

  /**
   * @param {TileGenerator} tileGenerator
   */
  constructor(tileGenerator) {
    super(tileGenerator.row, tileGenerator.col);
    this.#biome = tileGenerator.biome;
    this.#resource = tileGenerator.resource;
    this.#territory = tileGenerator.territory;
  }

  get populations() {
    return this.#populations;
  }
  get biome() {
    return this.#biome;
  }
  get resource() {
    return this.#resource;
  }
  get building() {
    return this.#building;
  }
  get territory() {
    return this.#territory;
  }

  /**
   * @param {Building} value
   */
  set building(value) {
    //we can build only on our territory without an building
    if (this.#territory === "initial" && !this.#building) {
      if (this.#biome === "mountain") {
        if (value === "mine" && this.#resource === "metal") {
          this.#resource = null;
          this.#building = value;
          this.#populations += MapExploiter.pop[value];
        } else if (value === "mountain temple") {
          this.#building = value;
          this.#populations += MapExploiter.pop[value];
        }
      }
    }
  }
}
