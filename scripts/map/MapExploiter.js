import { Map } from "./Map.js";
import { TileExploiter } from "./TileExploiter.js";

export class MapExploiter extends Map {
  static pop = {
    mine: 2,
    "mountain temple": 1,
  };

  /** @type {Number} */
  #populations = 0;
  /** @type {Number} */
  stars = 5;

  /**
   * @param {Map} map
   */
  constructor(map) {
    super(map.size);
    this.map = Array.from({ length: this.size ** 2 }, (_, i) => new TileExploiter(map.map[i]));
  }

  _exploitMountains() {
    //mine all the metal
    this.map.forEach((tile) => (tile.building = "mine"));
    //create temple
    this.map.forEach((tile) => (tile.building = "mountain temple"));
  }

  exploit() {
    this._exploitMountains();
    this.populations = this._calculatePopulations();
  }

  _calculatePopulations() {
    let populations = 0;
    this.map.map((tile) => (populations += tile.populations));
    return populations;
  }
  /**
   * @param {Number} value
   */
  set populations(value) {
    this.#populations = value;
    document.getElementById("populations").innerHTML = this.#populations;
  }
}
